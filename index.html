<html>
  <head>
    <title>Prize Papers WebVR data exploration tool</title>
    <meta name="description" content="Prize Papers WebVR data exploration tool"></meta>
    <!-- Openlayers -->
    <link rel="stylesheet" href="assets/ol/ol.css" type="text/css">
    <!-- The line below is only needed for old environments like Internet Explorer and Android 4.x -->
    <script src="assets/ol/polyfill.min.js"></script>
    <script src="https://openlayers.org/en/v4.6.5/build/ol-debug.js"></script>
    <!-- A-Frame -->
    <script src="assets/aframe/aframe.min.js"></script>
    <!-- aframe openlayers component -->
    <script src="assets/aframe-openlayers-component/build.js"></script> 
        <!-- aframe GUI component -->
    <script src="assets/aframe-gui/aframe-gui.js"></script> 
    <link rel="stylesheet" href="assets/aframe-gui/icons.css" type="text/css">
    <!-- main JS file -->
   <script src="js/app.js"></script> 
     <script>
     

		//// Create one openlayers map
		var source1 = new ol.source.OSM();
		var layer1 = new ol.layer.Tile({
		  source: source1
		});
		var source2 = new ol.source.Vector({
		    url: 'https://openlayers.org/en/v4.6.5/examples/data/geojson/countries.geojson',
		    format: new ol.format.GeoJSON()
		});
		var layer2 = new ol.layer.Vector({
		    source: source2
		});
			var source3 = new ol.source.Vector({
			    url: 'https://sigap.calisto.pt/prize-papers-api/ships?or_country=portugal',
			    format: new ol.format.GeoJSON()
			});
			var layer3 = new ol.layer.Vector({
			    source: source3
			}); 
		var map = new ol.Map({
		    layers: [
		        layer1,
		        layer2,
		        layer3
		    ],
		    target: 'map',
		    controls: ol.control.defaults({
		        attributionOptions: {
		            collapsible: false
		        }
		    }),
		    view: new ol.View({
		        center: [0, 0],
		        zoom: 0.7
		    })
		});
		//// Create one interaction
		var select = new ol.interaction.Select({
		    condition: ol.events.condition.click //Click interaction
		  });
		map.addInteraction(select);
		select.on('select', function(e) {
			if(e.selected.length>0){
				//console.log(e.selected[0].getGeometry().getExtent());
			}
			else{
				
			}
		  });
/* 		  // Replace ./data.json with your JSON feed
	     fetch('https://sigap.calisto.pt/prize-papers-api/ships?or_country=portugal').then(response => {
	       return response.json();
	     }).then(data => {
	       // Work with JSON data here
	       console.log(data.geodata);
 			var source3 = new ol.source.Vector({
			    url: 'http://localhost:5000/ships?country=portugal',
			    format: new ol.format.GeoJSON()
			});
			var layer3 = new ol.layer.Vector({
			    source: source3
			}); 
			map.addLayer(layer3);
	     }).catch(err => {
	       // Do something for an error here
	     }); */
	 </script>
  </head>
  <body>
    <a-scene>
		<a-assets>
		    <div id="map"></div>
		    <img id="gradient" src="assets/gradient.png">
			<img id="ground" src="assets/ground.png">
			<a-asset-item id="iconfont" src="assets/fonts/ionicons.ttf"></a-asset-item>
			<a-asset-item id="fontfamily" src="https://fonts.googleapis.com/css?family=Fira+Sans"></a-asset-item>
			<a-asset-item id="iconfont" src="assets/fonts/ionicons.ttf"></a-asset-item>
		</a-assets>
      	
      
		 <a-plane 
		   position="0 2 -2.5" 
		   height="2" 
		   width="4" 
		   color="#c4c4c4"
		   opacity="100"
		   ol="  map: map;
		   		 aframeEvent: click;
			     OlEvent: click;
		         pixToVRRatio:150;"
		></a-plane>
		<!-- Container for the left control panel (layers panel)-->
		<a-gui-flex-container 
			flex-direction="column" justify-content="flexStart" align-items="center" item-padding="0.1" component-padding="0.1" opacity="0.7" width="1" height="2"
			position="-2.6 2 -1.8" rotation="0 30 0"
		>
		</a-gui-flex-container>

		<!-- create the control panel -->
		<a-entity id="ctlPanel" position="0.05 1 -1.3" rotation="-30 0 0">
			<!-- panel index -->
			<a-gui-flex-container 
				flex-direction="column" justify-content="flexStart" align-items="flexStart" item-padding="0.1" component-padding="0.1" opacity="0.7" width="0.5" height="0.7"
				position="-0.8 0 0"
			>
				<a-gui-label 
						width="0.5" height="0.09"
						value="Years"
						font-family="Arial"
						font-size="15px"
						margin="0.00 0.00 0.02 0.0"
					>
				</a-gui-label>
				<a-gui-button 
				    id="ctlFilterBtn"
					width="0.5" height="0.08"
					value="1700 - 1709"
					toggle="true"
					onclick="onFilterBtn"
					font-family="Arial"
					font-size="15px"
					margin="0 0 0.02 0.01"
				>
				</a-gui-button>
				<a-gui-button 
					id="ctlMapSettingsBtn"
					width="0.5" height="0.08"
					value="1710 - 1719"
					toggle="true"
					onclick="onMapSettingsBtn"
					font-family="Arial"
					font-size="15px"
					margin="0 0 0.02 0.01"
				>
				</a-gui-button>
				<a-gui-button 
					id="ctlMapSettingsBtn"
					width="0.5" height="0.08"
					value="1770 - 1779"
					toggle="true"
					onclick="onMapSettingsBtn"
					font-family="Arial"
					font-size="15px"
					margin="0 0 0.02 0.01"
				>
				</a-gui-button>
				<a-gui-button 
					id="ctlMapSettingsBtn"
					width="0.5" height="0.08"
					value="1780 - 1789"
					toggle="true"
					onclick="onMapSettingsBtn"
					font-family="Arial"
					font-size="15px"
					margin="0 0 0.02 0.01"
				>
				</a-gui-button>
				<a-gui-button 
					id="ctlMapSettingsBtn"
					width="0.5" height="0.08"
					value="1790 - 1799"
					toggle="true"
					onclick="onMapSettingsBtn"
					font-family="Arial"
					font-size="15px"
					margin="0 0 0.02 0.01"
				>
				</a-gui-button>
				<a-gui-button 
					id="ctlMapSettingsBtn"
					width="0.5" height="0.08"
					value="1800 - 1803"
					toggle="true"
					onclick="onMapSettingsBtn"
					font-family="Arial"
					font-size="15px"
					margin="0 0 0.02 0.01"
				>
				</a-gui-button>
				<a-entity 	gui-item="type: flex-container; width: 0.5; height: 0.08;"
							gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.0; opacity: 0.0"
							position="0 0 0"
				>
				<a-gui-button 
					id="ctlMapSettingsBtn"
					width="0.2" height="0.08"
					value="costum"
					toggle="true"
					onclick="onMapSettingsBtn"
					font-family="Arial"
					font-size="15px"
					margin="0 0 0.02 0.01"
				>
				</a-gui-button>
				<a-gui-button 
					id="ctlMapSettingsBtn"
					width="0.2" height="0.08"
					value="costum2"
					toggle="true"
					onclick="onMapSettingsBtn"
					font-family="Arial"
					font-size="15px"
					margin="0 0 0.02 0.01"
				>
				</a-gui-button>
			</a-entity>
			</a-gui-flex-container>
			<!-- panel Origin country -->
			<a-gui-flex-container 
				flex-direction="column" justify-content="flexStart" align-items="flexStart" item-padding="0.1" component-padding="0.1" opacity="0.7" width="0.5" height="0.7"
				position="-0.28 0 0" visible="true"
			>
					<a-gui-label 
						width="0.5" height="0.09"
						value="Ship origin country"
						font-family="Arial"
						font-size="15px"
						margin="0.00 0.00 0.02 0.0"
					>
					</a-gui-label>
					<a-gui-button
						width="0.3" height="0.09"
						onclick="buttonActionFunction"
						value="Fr"
						font-size="15px"
						font-family="Arial"
						margin="0 0 0.02 0.01"
					>
					</a-gui-button>
					<a-gui-button
						width="0.3" height="0.09"
						onclick="buttonActionFunction"
						value="Nl"
						font-size="15px"
						font-family="Arial"
						margin="0 0 0.02 0.01"
					>
					</a-gui-button>
			</a-gui-flex-container>

			
			<!-- panel map settings -->
			<a-gui-flex-container 
				flex-direction="column" justify-content="flexStart" align-items="flexStart" item-padding="0.1" component-padding="0.1" opacity="0.7" width="1.5" height="0.7"
				position="0.2 0 0" visible="false"
			>
					<a-gui-toggle
						width="1" height="0.2"
						onclick="testToggleAction"
						value="world borders"
						border-width="0.5"
						font-size="20px"
						font-family="Arial"
						margin="0 0 0.05 0.05"
					>
					</a-gui-toggle>
					<a-gui-toggle
						width="1" height="0.2"
						onclick="testToggleAction"
						value="Ships route"
						border-width="0.5"
						font-size="20px"
						font-family="Arial"
						margin="0.05 0 0.05 0.05"
					>
					</a-gui-toggle>
			</a-gui-flex-container>
		</a-entity>
		
     	<!-- In case we have VR controls -->
		<a-entity laser-controls="hand: right"></a-entity>

 		<a-camera id="camera" position="0 1.6 0"  look-controls wasd-controls-enabled="true" >
		  <a-text id="infoText" color="grey" value="" position="0 -0.2 -1" scale="0.4 0.4 0.4"></a-text>
		  <a-cursor fuse="false" interval="1000"></a-cursor>
		</a-camera> 
		

 		<!-- Camera + cursor. -->
		<!--<a-entity id="cameraRig" position="0 0 0">
			<a-camera look-controls wasd-controls position="0 1.6 0">
				<a-gui-cursor id="cursor"
						  raycaster="objects: [gui-interactable]"
						  fuse="false"
				>
				</a-gui-cursor> /cursor
			</a-camera> /camera
		</a-entity> -->
		<a-sky src="#gradient"></a-sky>
  		<a-image position="0 -.025 0" height="300" width="300" rotation="90 0 0" src="#ground" repeat="300 300" material="color:#ebd9e9"></a-image>
  		
    </a-scene>
  </body>
</html>